<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>unittest, part 3 - Mere Code</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="unittest, part 3"/>
            <meta property="og:url" content="http://code.mumak.net/2010/08/unittest-part-3.html"/>
            <meta property="og:description" content="So far, we've talked about TestSuites, TestCases and TestResults. We've seen how these objects interact with each other and how they can generally be thought about as having more than one interface. TestResult has an interface for the TestCase and an interface used for querying ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://code.mumak.net/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="http://code.mumak.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://code.mumak.net/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://code.mumak.net/theme/css/style.css" type="text/css"/>

        <link href="http://code.mumak.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Mere Code ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://code.mumak.net/" class="navbar-brand">
Mere Code            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://code.mumak.net/blog/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://code.mumak.net/2010/08/unittest-part-3.html"
                       rel="bookmark"
                       title="Permalink to unittest, part 3">
                        unittest, part 3
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2010-08-14T14:34:00"> Sat 14 August 2010</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>So far, we've talked about <code>TestSuite</code>s, <code>TestCase</code>s and <code>TestResult</code>s.
We've seen how these objects interact with each other  and how they can
generally be thought about as having more than one interface.
<code>TestResult</code> has an interface for the <code>TestCase</code> and an interface used
for querying the results, <code>TestCase</code> has an interface for test runners
and an interface for test authors, and so forth.  </p>
<p>Now we need to give some time to the bits that glue everything together:
the test runner and the test loader.  </p>
<p><strong><code>TestRunner</code></strong>  </p>
<p>You will not find a class in unittest.py called <code>TestRunner</code>. A test
runner is simply something that takes user input about a test run – what
tests to run, what manner to run them in, how to display the results –
and does it.  </p>
<p>Essentially, it does something like this:</p>
<div class="highlight"><pre>  <span class="n">test</span> <span class="o">=</span> <span class="n">TestLoader</span><span class="p">().</span><span class="n">loadTests</span><span class="p">(</span><span class="n">user_specified_test_string</span><span class="p">)</span>  <span class="n">result</span> <span class="o">=</span> <span class="n">makeTestResult</span><span class="p">(</span><span class="n">options_specified_by_user</span><span class="p">)</span>  <span class="n">result</span><span class="p">.</span><span class="n">startTestRun</span><span class="p">()</span>  <span class="n">try</span><span class="o">:</span>    <span class="n">test</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="n">finally</span><span class="o">:</span>    <span class="n">result</span><span class="p">.</span><span class="n">stopTestRun</span><span class="p">()</span>
</pre></div>


<p>And that's it.  </p>
<p>You see that the test runner is responsible for instantiating the test
loader and the test result. It's perhaps excusable for a test runner to
be tightly bound to particular implementations of test loader and test
result. Certainly, before <code>TestResult</code> grew <code>startTestRun</code> and
<code>stopTestRun</code> it was inevitable: since the test runner was responsible
for summarizing the results of a test run, overall responsibility for
displaying the results was split between the runner and the result.  </p>
<p>Nowadays, the tight coupling can be limited. If your test runner has an
option to display stack traces as it gets them, then that's pretty much
going to force you to use a particular result. However, you can still
write your code internally such that someone could pass in a different
result that still works, even though it doesn't do exactly what the user
asked for.  </p>
<p><strong><code>TestLoader</code></strong>  </p>
<p>From the point of view of interfaces and compatibility, this is a pretty
boring class, and that's a good thing. The test loader's job is to find
tests based on some user input and construct a single <code>ITest</code> object for
them.  </p>
<p>When it does more than this, one runs the risk of having the behaviour
of a test suite depend too much on the runner itself. The ideal is to
have the test suite run in any runner: trial, nose, unittest2, py.test,
whatever.  </p>
<p>Some <code>TestLoader</code>s provide hooks so that users with complicated test
suites can customize the way their tests are loaded. Whenever the Trial
<code>TestLoader</code> sees a <code>test_suite()</code> function in a module, it lets that
function take charge of the loading.  </p>
<p>The standard library in 2.7 has a new hook, inspired by an innovation in
bzrlib, but slightly different.
<code>load_tests(loader, standard_tests, pattern)</code> is given the loader used
by the test runner, the tests that the loader would have loaded, and if
appropriate, a glob used for matching test module files. The advantage
of this hook is that it reduces the danger of customizations made to the
loader, since the test suite has access to the same loader. It also
makes custom loading easier by giving the standard tests as a starting
point. bzrlib uses this to run the same set of tests against many
implementations.  </p>
<p>I <em>think</em> that's all I have to say about these two, which means that's
pretty much all I have to say about unittest's API for test frameworks.
Still one more post to go though: interfaces for test authors.  </p>
<p>Let me know if I've missed anything, if anything here surprises you or
contradicts something I said in the past or if things are unclear. The
comments on the previous two posts have really helped!</p>
            </div>
            <!-- /.entry-content -->

        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">



                <li class="list-group-item"><a href="http://code.mumak.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                        <li class="list-group-item tag-1">
                            <a href="http://code.mumak.net/tag/uncategorized.html">
                                Uncategorized
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/hacking.html">
                                Hacking
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/testtools.html">
                                testtools
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/launchpad.html">
                                launchpad
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/bazaar.html">
                                Bazaar
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://code.mumak.net/tag/testing.html">
                                Testing
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/ubuntu.html">
                                ubuntu
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/twisted.html">
                                Twisted
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/launchpad-subunit-data.html">
                                launchpad subunit data
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/ui.html">
                                UI
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/subunit-data.html">
                                subunit data
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/personal.html">
                                Personal
                            </a>
                        </li>
                    </ul>
                </li>    

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2013 Jonathan M. Lange
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="//code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://code.mumak.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://code.mumak.net/theme/js/respond.min.js"></script>

</body>
</html>