<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Within You Without You - Mere Code</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Within You Without You"/>
            <meta property="og:url" content="http://code.mumak.net/2008/07/within-you-without-you.html"/>
            <meta property="og:description" content="Testing is hard, writing testing frameworks is easy. In an effort to make testing easier, big projects like Twisted, Bazaar and Zope write their own testing frameworks. That way they control both the test runner and the tests that are run. It's actually quite convenient. However, it's led ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://code.mumak.net/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="http://code.mumak.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://code.mumak.net/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://code.mumak.net/theme/css/style.css" type="text/css"/>

        <link href="http://code.mumak.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Mere Code ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://code.mumak.net/" class="navbar-brand">
Mere Code            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://code.mumak.net/blog/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://code.mumak.net/2008/07/within-you-without-you.html"
                       rel="bookmark"
                       title="Permalink to Within You Without You">
                        Within You Without You
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2008-07-05T11:21:00"> Sat 05 July 2008</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://code.mumak.net/tag/testing.html">Testing</a>
        /
	<a href="http://code.mumak.net/tag/hacking.html">Hacking</a>
        /
	<a href="http://code.mumak.net/tag/twisted.html">Twisted</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Testing is hard, writing testing frameworks is easy. In an effort to
make testing easier, big projects like Twisted, Bazaar and Zope write
their own testing frameworks. That way they control both the test runner
and the tests that are run. It's actually quite convenient.  </p>
<p>However, it's led to a significant problem:  </p>
<blockquote>
<p>There are many similar implementations of xUnit in Python, each with
subtle incompatibilities.</p>
</blockquote>
<p>Running Twisted tests in the Zope test runner? Watch out for the threads
that the reactor maintains between tests. Running Bazaar tests with
Trial? On my machine, I get told that elementtree doesn't have an
'ElementTree' attribute. Hmm.  </p>
<p>When talking about this problem, I often refer loosely to "PyUnit
compatibilty". The idea is that:  </p>
<ol>
<li>Every Python test runner should support running vanilla Python
    standard library <code>unittest.TestCase</code> tests.</li>
<li>Every Python unit test should be able to be run using the mechanisms
    in <code>unittest.py</code> in the Python standard library.</li>
</ol>
<p>In other words, this code should Just Work:  </p>
<p><code>{lang="python"}
import unittestfrom yourframework import testingclass PythonTestCase(unittest.TestCase):    def test_something(self):        passclass FrameworkTestCase(testing.TestCase):    def test_something(self):        passif __name__ == '__main__':    python_test_result = unittest.TestResult()    framework_test_result = testing.TestResult()    FrameworkTestCase('test_something').run(python_test_result)    FrameworkTestCase('test_something').run(framework_test_result)    PythonTestCase('test_something').run(python_test_result)    PythonTestCase('test_something').run(framework_test_result)    # At this point, python_test_result and framework_test_result    # should hold equivalent data.</code></p>
<p>If your framework is PyUnit compatible then the above fragment should
give the same results if run directly or if run in your runner. Things
get a little bit hazier when it comes to test discovery.  </p>
<p>So, if your unit test requires that it be run inside a special suite
(e.g. <code>TrialSuite</code>) in order to work correctly, it is not PyUnit
compatible. If your test runner does some critical set up that enables
features that your tests need, then it is not PyUnit compatible.  </p>
<p>This leads to a kind of thinking where certain features belong on the
base test case and others belong in the test runner. Putting features in
the wrong place might not lead to a strict incompatibility, but it can
lead to significant inconvenience. (And what are automated tests if not
a convenience?).  </p>
<p>Two examples from Twisted:  </p>
<p><strong>Temporary Working Directory</strong>  </p>
<p>Trial creates a <code>_trial_temp</code> working directory and changes into that
directory to run tests. In Trial, this feature is provided by the test
runner. It should be provided by the base <code>TestCase</code> class.  </p>
<ul>
<li>It's not clear that every test needs this feature.</li>
<li>Twisted tests now assume that they can create files with impunity.
    When Twisted tests are run in a different test runner, they leave
    garbage files everywhere.</li>
</ul>
<p><strong>Timeouts</strong>  </p>
<p>By default, any Trial test that runs for more than two minutes will fail
with a timeout error. The timeout period can be configured on a
per-test, per-test-class, per-module or per-package basis. Trial
implements this feature on <code>TestCase</code>, it should be implemented on the
runner.  </p>
<ul>
<li>Even in the Twisted test runner, this makes debugging more painful.
    You must do all of your debugging in under two minutes.</li>
<li>Intuitively, you might think that the <em>runner</em> should control how
    tests are <em>run</em>.</li>
<li>Tests that don't descend from Trial's <code>TestCase</code> can still hang.</li>
<li>Two minutes might be good enough for me on a Monday, but I might be
    busier on Friday. I should be able to change the timeout without
    changing code.</li>
</ul>
            </div>
            <!-- /.entry-content -->

        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">



                <li class="list-group-item"><a href="http://code.mumak.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                        <li class="list-group-item tag-1">
                            <a href="http://code.mumak.net/tag/uncategorized.html">
                                Uncategorized
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/launchpad.html">
                                launchpad
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/hacking.html">
                                Hacking
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/bazaar.html">
                                Bazaar
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://code.mumak.net/tag/testtools.html">
                                testtools
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://code.mumak.net/tag/testing.html">
                                Testing
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/subunit-data.html">
                                subunit data
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/ubuntu.html">
                                ubuntu
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/twisted.html">
                                Twisted
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/ui.html">
                                UI
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/personal.html">
                                Personal
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://code.mumak.net/tag/launchpad-subunit-data.html">
                                launchpad subunit data
                            </a>
                        </li>
                    </ul>
                </li>    

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2013 Jonathan M. Lange
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="//code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://code.mumak.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://code.mumak.net/theme/js/respond.min.js"></script>

</body>
</html>